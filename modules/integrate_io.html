

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>integrate_io &mdash; INTEGRATE  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="integrate_plot" href="integrate_plot.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            INTEGRATE
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gettingstarted.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../format.html">Data format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../workflow.html">Workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks.html">Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributions.html">Contributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../modules.html">Modules (documentation)</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="integrate.html">integrate</a></li>
<li class="toctree-l2"><a class="reference internal" href="integrate_plot.html">integrate_plot</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">integrate_io</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">INTEGRATE</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../modules.html">Modules (documentation)</a></li>
      <li class="breadcrumb-item active">integrate_io</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/modules/integrate_io.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="integrate-io">
<h1>integrate_io<a class="headerlink" href="#integrate-io" title="Link to this heading"></a></h1>
<p>Functions related to IO in the INTEGRATE module.</p>
<p>INTEGRATE I/O Module - Data Input/Output and File Management</p>
<p>This module provides comprehensive input/output functionality for the INTEGRATE
geophysical data integration package. It handles reading and writing of HDF5 files,
data format conversions, and management of prior/posterior data structures.</p>
<dl class="simple">
<dt>Key Features:</dt><dd><ul class="simple">
<li><p>HDF5 file I/O for prior models, data, and posterior results</p></li>
<li><p>Support for multiple geophysical data formats (GEX, STM, USF)</p></li>
<li><p>Automatic data validation and format checking</p></li>
<li><p>File conversion utilities between different formats</p></li>
<li><p>Data merging and aggregation functions</p></li>
<li><p>Checksum verification and file integrity checks</p></li>
</ul>
</dd>
<dt>Main Functions:</dt><dd><ul class="simple">
<li><p>load_*(): Functions for loading prior models, data, and results</p></li>
<li><p>save_*(): Functions for saving prior models and data arrays</p></li>
<li><p>read_*(): File format readers (GEX, USF, etc.)</p></li>
<li><p>write_*(): File format writers and converters</p></li>
<li><p>merge_*(): Data and posterior merging utilities</p></li>
</ul>
</dd>
<dt>File Format Support:</dt><dd><ul class="simple">
<li><p>HDF5: Primary data storage format</p></li>
<li><p>GEX: Geometry and survey configuration files</p></li>
<li><p>STM: System transfer function files</p></li>
<li><p>USF: Field measurement files</p></li>
<li><p>CSV: Export format for GIS integration</p></li>
</ul>
</dd>
</dl>
<p>Author: Thomas Mejer Hansen
Email: <a class="reference external" href="mailto:tmeha&#37;&#52;&#48;geo&#46;au&#46;dk">tmeha<span>&#64;</span>geo<span>&#46;</span>au<span>&#46;</span>dk</a></p>
<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">integrate_io.</span></span><span class="sig-name descname"><span class="pre">check_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f_data_h5</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'data.h5'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>Check and update INTEGRATE data in an HDF5 file.</p>
<p>This function validates and ensures the presence of essential geometry datasets
(UTMX, UTMY, LINE, ELEVATION) in an HDF5 file. If any datasets are missing,
it creates them using provided values or sensible defaults based on existing data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f_data_h5</strong> (<em>str</em><em>, </em><em>optional</em>) – Path to the HDF5 file to check and update</p></li>
<li><p><strong>kwargs</strong> (<em>dict</em>) – Additional keyword arguments for dataset values and configuration</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None (modifies the HDF5 file in place)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>KeyError</strong> – If the ‘D1/d_obs’ dataset is not found in the file and ‘UTMX’ is not provided</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Supported Keyword Arguments:</strong></p>
<ul class="simple">
<li><p>showInfo (int): Verbosity level. If greater than 0, prints information messages. Default is 0.</p></li>
<li><p>UTMX (array-like): Array of UTMX coordinate values. If not provided, attempts to read from file or generates defaults.</p></li>
<li><p>UTMY (array-like): Array of UTMY coordinate values. Default is zeros array with same length as UTMX.</p></li>
<li><p>LINE (array-like): Array of survey line identifiers. Default is ones array with same length as UTMX.</p></li>
<li><p>ELEVATION (array-like): Array of elevation values. Default is zeros array with same length as UTMX.</p></li>
</ul>
<p><strong>Behavior:</strong></p>
<ul class="simple">
<li><p>If UTMX is not provided, function attempts to determine array length from existing ‘D1/d_obs’ dataset</p></li>
<li><p>Missing datasets are created with appropriate default values</p></li>
<li><p>Existing datasets are preserved and not overwritten</p></li>
</ul>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">integrate_io.</span></span><span class="sig-name descname"><span class="pre">copy_hdf5_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loadToMemory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>Copy the contents of an HDF5 file to another HDF5 file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_filename</strong> (<em>str</em>) – The path to the input HDF5 file.</p></li>
<li><p><strong>output_filename</strong> (<em>str</em>) – The path to the output HDF5 file.</p></li>
<li><p><strong>N</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of elements to copy from each dataset. If not specified, all elements will be copied.</p></li>
<li><p><strong>loadToMemory</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to load the entire dataset to memory before slicing. Default is True.</p></li>
<li><p><strong>compress</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to compress the output dataset. Default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">integrate_io.</span></span><span class="sig-name descname"><span class="pre">download_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">url</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">download_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_checksum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>Download a file from a URL to a specified directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>url</strong> (<em>str</em>) – The URL of the file to download.</p></li>
<li><p><strong>download_dir</strong> (<em>str</em>) – The directory to save the downloaded file.</p></li>
<li><p><strong>use_checksum</strong> (<em>bool</em>) – Whether to verify the file checksum after download.</p></li>
<li><p><strong>kwargs</strong> – Additional keyword arguments.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">integrate_io.</span></span><span class="sig-name descname"><span class="pre">download_file_old</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">url</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">download_dir</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>Download a file from a URL to a specified directory (old version).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>url</strong> (<em>str</em>) – The URL of the file to download.</p></li>
<li><p><strong>download_dir</strong> (<em>str</em>) – The directory to save the downloaded file.</p></li>
<li><p><strong>kwargs</strong> – Additional keyword arguments.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">integrate_io.</span></span><span class="sig-name descname"><span class="pre">file_checksum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>Calculate the MD5 checksum of a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file_path</strong> (<em>str</em>) – The path to the file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The MD5 checksum of the file.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">integrate_io.</span></span><span class="sig-name descname"><span class="pre">get_case_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">case</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'DAUGAARD'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loadAll</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loadType</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filelist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>Get case data for a specific case.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>case</strong> (<em>str</em>) – The case name. Default is ‘DAUGAARD’. Options are ‘DAUGAARD’, ‘GRUSGRAV’, ‘FANGEL’, ‘HALD’, ‘ESBJERG’, and ‘OERUM.</p></li>
<li><p><strong>loadAll</strong> (<em>bool</em>) – Whether to load all files for the case. Default is False.</p></li>
<li><p><strong>loadType</strong> (<em>str</em>) – The type of files to load. Options are ‘’, ‘prior’, ‘prior_data’, ‘post’, and ‘inout’.</p></li>
<li><p><strong>filelist</strong> (<em>list</em>) – A list of files to load. Default is an empty list.</p></li>
<li><p><strong>kwargs</strong> – Additional keyword arguments.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of file names for the case.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">integrate_io.</span></span><span class="sig-name descname"><span class="pre">get_geometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f_data_h5</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>Retrieve geometry information from an HDF5 file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>f_data_h5</strong> (<em>str</em>) – The path to the HDF5 file. If a posterior HDF5 file is passed, the corresponding data file is read from the ‘h5_data’ attribute</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the X, Y, LINE, and ELEVATION arrays</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>IOError</strong> – If the HDF5 file cannot be opened or read</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Example usage:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">LINE</span><span class="p">,</span> <span class="n">ELEVATION</span> <span class="o">=</span> <span class="n">get_geometry</span><span class="p">(</span><span class="s1">&#39;/path/to/file.h5&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">integrate_io.</span></span><span class="sig-name descname"><span class="pre">get_gex_file_from_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f_data_h5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>Retrieves the ‘gex’ attribute from the specified HDF5 file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f_data_h5</strong> (<em>str</em>) – The path to the HDF5 file.</p></li>
<li><p><strong>id</strong> (<em>int</em>) – The ID of the dataset within the HDF5 file. Defaults to 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The value of the ‘gex’ attribute if found, otherwise an empty string.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">integrate_io.</span></span><span class="sig-name descname"><span class="pre">gex_to_stm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_gex</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>Convert a GEX file to STM files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_gex</strong> (<em>str</em><em> or </em><em>dict</em>) – The path to the GEX file or a GEX dictionary.</p></li>
<li><p><strong>kwargs</strong> – Additional keyword arguments to be passed to the write_stm_files function.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the STM files and the GEX dictionary.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>TypeError</strong> – If the file_gex argument is not a string or a dictionary.</p>
</dd>
<dt class="field-odd">Notes<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p>If the file_gex argument is a string, it is assumed to be the path to the GEX file, which will be read using the read_gex function.</p></li>
<li><p>If the file_gex argument is a dictionary, it is assumed to be a GEX dictionary.</p></li>
<li><p>The write_stm_files function is called to generate the STM files based on the GEX data.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">integrate_io.</span></span><span class="sig-name descname"><span class="pre">hdf5_scan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>Scans an HDF5 file and prints information about datasets (including their size) and attributes.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>file_path (str): The path to the HDF5 file.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">integrate_io.</span></span><span class="sig-name descname"><span class="pre">load_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f_data_h5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[1]</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>Load observational data from an HDF5 file.</p>
<p>This function loads observed electromagnetic data including measurements, uncertainties,
covariance matrices, and associated metadata from structured HDF5 files. Supports
multiple data types and automatic handling of missing data components.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f_data_h5</strong> (<em>str</em>) – Path to the HDF5 file containing the observational data</p></li>
<li><p><strong>id_arr</strong> (<em>list</em><em> of </em><em>int</em><em>, </em><em>optional</em>) – List of dataset identifiers to load from the file</p></li>
<li><p><strong>kwargs</strong> (<em>dict</em>) – Additional arguments including showInfo for verbosity control</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>Dictionary containing loaded data with the following keys:</p>
<ul class="simple">
<li><p>’noise_model’: Noise model type for each dataset (list of str)</p></li>
<li><p>’d_obs’: Observed data measurements (list of numpy.ndarray)</p></li>
<li><p>’d_std’: Standard deviations of observations (list of numpy.ndarray or None)</p></li>
<li><p>’Cd’: Full covariance matrices (list of numpy.ndarray or None)</p></li>
<li><p>’id_arr’: Dataset identifiers that were loaded (list of int)</p></li>
<li><p>’i_use’: Data point usage indicators (list of numpy.ndarray)</p></li>
<li><p>’id_use’: Dataset usage identifiers (list of int or numpy.ndarray)</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Missing data components (d_std, Cd, i_use, id_use) are automatically handled:
missing id_use defaults to sequential IDs, missing i_use defaults to all ones,
missing d_std and Cd remain as None.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">integrate_io.</span></span><span class="sig-name descname"><span class="pre">load_prior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f_prior_h5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_use</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Randomize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>Load prior data from an HDF5 file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f_prior_h5</strong> (<em>str</em>) – Path to the prior HDF5 file.</p></li>
<li><p><strong>N_use</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of samples to use. Default is 0, which means all samples.</p></li>
<li><p><strong>idx</strong> (<em>list</em><em>, </em><em>optional</em>) – List of indices to use. If empty, all indices are used.</p></li>
<li><p><strong>Randomize</strong> (<em>bool</em><em>, </em><em>optional</em>) – Flag indicating whether to randomize the order of the samples. Default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary containing the loaded prior data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">integrate_io.</span></span><span class="sig-name descname"><span class="pre">load_prior_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f_prior_h5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id_use</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_use</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Randomize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>Load prior data from an HDF5 file.</p>
<p>This function loads forward modeled data arrays from the prior structure,
supporting selective loading by data identifier, sample indices, and size limits.
The data can be optionally randomized for sampling purposes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f_prior_h5</strong> (<em>str</em>) – Path to the prior HDF5 file containing data arrays</p></li>
<li><p><strong>id_use</strong> (<em>list</em><em>, </em><em>optional</em>) – List of data identifiers to load. If empty, loads all available data types</p></li>
<li><p><strong>idx</strong> (<em>list</em><em>, </em><em>optional</em>) – List of sample indices to load. If empty, uses N_use or all samples</p></li>
<li><p><strong>N_use</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of samples to load. If 0, loads all available samples</p></li>
<li><p><strong>Randomize</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, randomizes the order of loaded samples</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple containing (D, idx) where D is list of data arrays and idx is array of used indices</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Data arrays are expected to be stored in HDF5 groups named ‘/D1’, ‘/D2’, etc.
The function automatically detects available data types if id_use is empty.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">integrate_io.</span></span><span class="sig-name descname"><span class="pre">load_prior_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f_prior_h5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">im_use</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_use</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Randomize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>Load prior model data from an HDF5 file.</p>
<p>This function loads model parameter arrays from the prior structure with flexible
indexing and sampling options.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f_prior_h5</strong> (<em>str</em>) – Path to the HDF5 file containing the prior model data</p></li>
<li><p><strong>im_use</strong> (<em>list</em><em>, </em><em>optional</em>) – List of model indices to use. If empty, all models are used</p></li>
<li><p><strong>idx</strong> (<em>list</em><em>, </em><em>optional</em>) – List of indices to select from the data. If empty, indices are generated based on N_use and Randomize</p></li>
<li><p><strong>N_use</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of samples to use. If 0, all samples are used</p></li>
<li><p><strong>Randomize</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, indices are randomized. If False, sequential indices are used</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple containing (M, idx) where M is list of arrays containing selected data for each model and idx is array of indices used to select the data</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the length of idx is not equal to N_use</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">integrate_io.</span></span><span class="sig-name descname"><span class="pre">merge_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_gex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta_line</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_data_merged_h5</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>Merge multiple data files into a single HDF5 file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f_data</strong> (<em>list</em>) – List of input data files to merge.</p></li>
<li><p><strong>f_gex</strong> (<em>str</em><em>, </em><em>optional</em>) – Path to geometry exchange file, by default ‘’.</p></li>
<li><p><strong>delta_line</strong> (<em>int</em><em>, </em><em>optional</em>) – Line number increment for each merged file, by default 0.</p></li>
<li><p><strong>f_data_merged_h5</strong> (<em>str</em><em>, </em><em>optional</em>) – Output merged HDF5 file path, by default derived from f_gex.</p></li>
<li><p><strong>kwargs</strong> – Additional keyword arguments.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Filename of the merged HDF5 file.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If f_data is not a list.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">integrate_io.</span></span><span class="sig-name descname"><span class="pre">merge_posterior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f_post_h5_files</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_data_h5_files</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_post_merged_h5</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>Merge multiple posterior HDF5 files and their corresponding data files.</p>
<p>This function combines multiple posterior sampling results and their associated
observational data files into single merged files for comprehensive analysis.
Useful for aggregating results from different survey areas or time periods.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f_post_h5_files</strong> (<em>list</em><em> of </em><em>str</em>) – List of file paths to the posterior HDF5 files to be merged</p></li>
<li><p><strong>f_data_h5_files</strong> (<em>list</em><em> of </em><em>str</em>) – List of file paths to the data HDF5 files corresponding to the posterior files</p></li>
<li><p><strong>f_post_merged_h5</strong> (<em>str</em><em>, </em><em>optional</em>) – File path for the merged posterior HDF5 file. If empty, generates default name</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple containing (merged_posterior_file_path, merged_data_file_path)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the length of f_data_h5_files is not the same as f_post_h5_files</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>File Naming:</strong></p>
<ul class="simple">
<li><p>If f_post_merged_h5 is not provided, uses format: ‘POST_merged_N{number_of_files}.h5’</p></li>
<li><p>Data file uses format: ‘DATA_merged_N{number_of_files}.h5’</p></li>
</ul>
<p><strong>Dependencies:</strong></p>
<ul class="simple">
<li><p>Requires the merge_data function to be available for merging observational data</p></li>
<li><p>Posterior files must have compatible structure for merging</p></li>
</ul>
<p><strong>Merging Process:</strong></p>
<ul class="simple">
<li><p>Combines posterior sampling results from multiple files</p></li>
<li><p>Merges corresponding observational data</p></li>
<li><p>Maintains data integrity and structure consistency</p></li>
</ul>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">integrate_io.</span></span><span class="sig-name descname"><span class="pre">post_to_csv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f_post_h5</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Mstr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'/M1'</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>Convert a post-processing HDF5 file to a CSV file containing XYZ data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f_post_h5</strong> (<em>str</em>) – Path to the post-processing HDF5 file. If not provided, the last used file will be used.</p></li>
<li><p><strong>Mstr</strong> (<em>str</em>) – The dataset path within the HDF5 file. Default is ‘/M1’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Path to the generated CSV file.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>KeyError</strong> – If the specified dataset path does not exist in the HDF5 file.</p></li>
<li><p><strong>FileNotFoundError</strong> – If the specified HDF5 file does not exist.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">integrate_io.</span></span><span class="sig-name descname"><span class="pre">read_gex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_gex</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>Read a GEX file and parse its contents into a dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_gex</strong> (<em>str</em>) – The path to the GEX file.</p></li>
<li><p><strong>kwargs</strong> (<em>dict</em>) – Additional keyword arguments for customization.</p></li>
<li><p><strong>Nhank</strong> (<em>int</em>) – The number of Hankel transform abscissae for both low and high frequency windows.</p></li>
<li><p><strong>Nfreq</strong> (<em>int</em>) – The number of frequencies per decade for both low and high frequency windows.</p></li>
<li><p><strong>Ndig</strong> (<em>int</em>) – The number of digits for waveform digitizing frequency.</p></li>
<li><p><strong>showInfo</strong> (<em>int</em>) – Flag to control the display of information. Default is 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary containing the parsed contents of the GEX file.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>FileNotFoundError</strong> – If the specified GEX file does not exist.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">integrate_io.</span></span><span class="sig-name descname"><span class="pre">read_usf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span></dt>
<dd><p>Read a Universal Sounding Format (USF) file and parse its contents.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>file_path: Path to the USF file</p>
</dd>
<dt>Returns:</dt><dd><p>Dictionary containing all parsed parameters from the USF file</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">integrate_io.</span></span><span class="sig-name descname"><span class="pre">read_usf_mul</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'.'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ext</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'.usf'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span></dt>
<dd><p>Read all USF files in a specified directory and return a list of USF data structures.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>directory: Path to the directory containing USF files (default: current directory)
ext: File extension to look for (default: “.usf”)</p>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>tuple containing:</dt><dd><ul class="simple">
<li><p>np.ndarray: Array of observed data (d_obs) from all USF files</p></li>
<li><p>np.ndarray: Array of relative errors (d_rel_err) from all USF files</p></li>
<li><p>List[Dict[str, Any]]: List of USF data structures, each representing a single USF file</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">integrate_io.</span></span><span class="sig-name descname"><span class="pre">save_prior_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f_prior_h5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D_new</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_delete</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>Save new prior data arrays to an HDF5 file.</p>
<p>This function saves forward modeled data arrays to the prior structure with automatic
or manual data identifier assignment. Supports replacing existing data arrays.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f_prior_h5</strong> (<em>str</em>) – Path to the HDF5 file where the prior data will be saved</p></li>
<li><p><strong>D_new</strong> (<em>numpy.ndarray</em>) – The new prior data array to be saved</p></li>
<li><p><strong>id</strong> (<em>int</em><em>, </em><em>optional</em>) – Data identifier to use as the key. If None, auto-generates next available ID</p></li>
<li><p><strong>force_delete</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, deletes existing data with the same ID before saving</p></li>
<li><p><strong>kwargs</strong> (<em>dict</em>) – Additional arguments including showInfo for verbosity control</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The data identifier used for saving the data</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Data arrays are stored in HDF5 groups named ‘/D1’, ‘/D2’, etc. The function
automatically determines the next available ID if id is None.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">integrate_io.</span></span><span class="sig-name descname"><span class="pre">save_prior_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f_prior_h5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M_new</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">im</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_replace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delete_if_exist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>Save new prior model data to an HDF5 file.</p>
<p>This function saves model parameter arrays to the prior structure with automatic
or manual model identifier assignment. Supports replacing existing models and
optional file deletion for clean saves.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f_prior_h5</strong> (<em>str</em>) – Path to the HDF5 file where the prior model data will be saved</p></li>
<li><p><strong>M_new</strong> (<em>numpy.ndarray</em>) – The new prior model data array to be saved</p></li>
<li><p><strong>im</strong> (<em>int</em><em>, </em><em>optional</em>) – Model identifier to use as the key. If None, auto-generates next available ID</p></li>
<li><p><strong>force_replace</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, replaces existing model data with the same ID</p></li>
<li><p><strong>delete_if_exist</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, deletes the entire file before saving new data</p></li>
<li><p><strong>kwargs</strong> (<em>dict</em>) – Additional arguments including showInfo for verbosity control</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The model identifier used for saving the data</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Model data is stored in HDF5 groups named ‘/M1’, ‘/M2’, etc. The function
automatically determines the next available ID if im is None.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">integrate_io.</span></span><span class="sig-name descname"><span class="pre">test_read_usf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span></dt>
<dd><p>Test function to read a USF file and print some key values.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>file_path: Path to the USF file</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">integrate_io.</span></span><span class="sig-name descname"><span class="pre">write_data_gaussian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D_std</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_std</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Cd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_data_h5</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'data.h5'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>Write Gaussian noise data to an HDF5 file.</p>
<p>This function writes observed data and its associated Gaussian noise standard deviations
to an HDF5 file. It also creates necessary datasets if they do not exist and handles
optional attributes for electromagnetic data processing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>D_obs</strong> (<em>numpy.ndarray</em>) – Observed data array</p></li>
<li><p><strong>D_std</strong> (<em>list</em><em>, </em><em>optional</em>) – Standard deviation of the observed data. If not provided, calculated using d_std</p></li>
<li><p><strong>d_std</strong> (<em>list</em><em>, </em><em>optional</em>) – Default standard deviation multiplier. Used if D_std is not provided</p></li>
<li><p><strong>Cd</strong> (<em>list</em><em>, </em><em>optional</em>) – Covariance data. If provided, it is written to the file</p></li>
<li><p><strong>id</strong> (<em>int</em><em>, </em><em>optional</em>) – Identifier for the dataset group</p></li>
<li><p><strong>is_log</strong> (<em>int</em><em>, </em><em>optional</em>) – Flag indicating if the data is in logarithmic scale</p></li>
<li><p><strong>f_data_h5</strong> (<em>str</em><em>, </em><em>optional</em>) – Path to the HDF5 file</p></li>
<li><p><strong>kwargs</strong> (<em>dict</em>) – Additional keyword arguments</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Path to the HDF5 file</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Additional Parameters (kwargs):</strong></p>
<ul class="simple">
<li><p>showInfo (int): Level of verbosity for printing information. Default is 0.</p></li>
<li><p>f_gex (str): Name of the GEX file associated with the data. Default is empty string.</p></li>
</ul>
<p><strong>Behavior:</strong></p>
<ul class="simple">
<li><p>If D_std is not provided, it is calculated as d_std * D_obs</p></li>
<li><p>The function ensures that datasets ‘UTMX’, ‘UTMY’, ‘LINE’, and ‘ELEVATION’ exist</p></li>
<li><p>If a group with name ‘D{id}’ exists, it is removed before adding new data</p></li>
<li><p>Writes attributes ‘noise_model’ and ‘is_log’ to the dataset group</p></li>
</ul>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">integrate_io.</span></span><span class="sig-name descname"><span class="pre">write_data_multinomial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i_use</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id_use</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_data_h5</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'data.h5'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>Writes observed data to an HDF5 file in a specified group with a multinomial noise model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>D_obs</strong> (<em>numpy.ndarray</em>) – The observed data array to be written to the file.</p></li>
<li><p><strong>id</strong> (<em>list</em><em>, </em><em>optional</em>) – The ID of the group to write the data to. If not provided, the function will find the next available ID.</p></li>
<li><p><strong>id_use</strong> (<em>list</em><em>, </em><em>optional</em>) – The ID of PRIOR data the refer to this data. If not set, id_use=id</p></li>
<li><p><strong>f_data_h5</strong> (<em>str</em><em>, </em><em>optional</em>) – The path to the HDF5 file where the data will be written. Default is ‘data.h5’.</p></li>
<li><p><strong>kwargs</strong> – Additional keyword arguments.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The path to the HDF5 file where the data was written.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">integrate_io.</span></span><span class="sig-name descname"><span class="pre">write_stm_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">GEX</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>Write STM (System Transfer Matrix) files based on the provided GEX system data file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>GEX</strong> (<em>dict</em>) – The GEX data containing the system information.</p></li>
<li><p><strong>kwargs</strong> (<em>dict</em>) – Additional keyword arguments for customization.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of file paths for the generated STM files.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="integrate_plot.html" class="btn btn-neutral float-left" title="integrate_plot" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023,2024,2025 INTEGRATE WORKING GROUP.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>